<div class="container-fluid">
  <div class="row flex-nowrap">
    <%= render 'admin/shared/side_nav' %>

    <div class="col p-0">
      <%= render 'admin/shared/nav' %>

      <div class="container-fluid ">
        <h1>Invites List</h1>
        <table class="table table-striped table-bordered mt-2">
          <thead>
          <tr>
            <td>Parent Email</td>
            <td>Email</td>
            <td>Total Deposit</td>
            <td>Member Total Deposits</td>
            <td>Coins</td>
            <td>Total Used Coins</td>
            <td>Children Members</td>
            <td>Created At</td>
          </tr>
          </thead>
          <tbody>
          <% @clients.each do |client| %>
            <tr>
              <td class="text-nowrap"><%= client.parent&.email || 'N/A' %></td>
              <td class="text-nowrap"><%= client.email %></td>
              <td class="text-nowrap text-end"><%= client.total_deposit %></td>
              <td class="text-nowrap text-end"><%= client.children.sum(:total_deposit) %></td>
              <td class="text-nowrap text-center"><%= client.coins %></td>
              <td class="text-nowrap text-center"><%= Ticket.includes(:user).where(users: { id: client }).sum(:coins) %></td>
              <td class="text-nowrap"><%= client.children_members %></td>
              <td class="text-nowrap text-center"><%= client.created_at.strftime("%Y/%m/%d %I:%M %p") %></td>
            </tr>
          <% end %>
          </tbody>
        </table>
        <%= paginate @clients %>
      </div>

    </div>
  </div>
</div>